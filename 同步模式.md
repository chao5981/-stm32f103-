  同步和级联模式是定时器中的重要概念，这里将以最简单的理解方式讲解并说明配置时的细节。

  级联模式：扩展定时器的计数范围（将一个定时器的输出作为另一个的时钟输入）。例如主从均为16位时，理论可达32位。

  我个人感觉级联模式非常鸡肋，如果你要扩展计数时长，在一般情况下完全可以学基本TIM那样的中断，再不济也可以调节ARR(自动重载寄存器)和CCR(重复计数器)去调节时间，一个u32类型的应该就绰绰的了。要是担心爆栈而省这么个三瓜俩枣地采用级联模式，那只能说你很极限了。

  现在请你直接看“同步模式”这四个词，仅仅凭借词义，你能猜出来这个功能的作用吗？

  或许你们脑海里第一个蹦出的念头是：同时开启/或者关闭定时器，实现同时开启PWM信号的作用

  如果有这种想法，你自己推理一下，如果我只是要同步开启或者关闭的话，那我同时使能或停止几个定时器就不好了，或者我们全部定时器选择同一个触发源，那而不是能实现同步开启和关闭吗，为什么还要单独把同步这个概念领出来呢？

  所以，这并不是同步模式的核心价值所在！

  如果开启时有误差，随着时间不断积累怎么办？如果时钟抖动，他们还如何实现同步？

  所以，同步模式的核心价值是什么，并不是简单的同时开启和同时关闭，而是运行过程中的持续同步和误差矫正！即使出现了误差，这一个周期有微小的不同步，我下个周期直接给它调回来。以保证持续矫正，误差不累积！

  想必已经了解了同步模式的核心，在介绍如何配置之前，还需要了解俩个概念：主模式和从模式；重映射

    1.主模式：主模式下，定时器作为主动设备，通过 触发输出（TRGO） 向其他定时器发送控制信号。TRGO 可以输出多种事件，如更新事件、捕获事件等。
    2.从模式：从模式下，定时器作为 被动设备，其行为（如启动、停止、复位）由外部触发信号控制。
    这个触发信号可以来自：
          a.其他定时器的输出（如 TRGO 信号）
          b.外部引脚（如 ETR）
          c.内部触发源（如 ITR0~ITR3）

    3.重映射：可以让你将外设的功能重新映射到其他引脚上，从而增加了硬件设计的灵活性。例如在stm32f103上，TIM1_CH1可选择从PA8/PE9引脚输出
    信号，默认为PA8，如果PA8引脚被占用或者用PA8引脚由于线路过长导致出现了误差，我们可以利用重映射改变TIM1_CH1的输出引脚为PE9。
    但是重映射不能将外设功能随意映射到任意引脚，必须遵循芯片硬件设计中预设的 "可重映射引脚列表"。

好了，基础知识已经有储备了，我们还需要了解各个计时器的频率和占空比的计算公式：

    对于频率：
      1.对于主计时器，它的频率就是f1=TIMx_CLK/[(ARR1+1)*(PSC1+1)]
      2.而对于从计时器，其频率的计算公式为：f2=f1/[(ARR2+1)*(PSC2+1)]
      若还有从从计时器，那就以此类推。

    对于占空比：无论是主计时器还是从计时器的都一样，占空比=Pulse/(ARR+1)

现在开始讲解配置的细节要点。

这里我以TIM2为主计时器，TIM3为从计时器，TIM4为从从计时器。并且把一部分引脚进行重映射。

1.重映射配置：在正常的GPIO配置上调用GPIO_PinRemapConfig()函数，并且使能AFIO时钟(RCC_APB2Periph_AFIO);

2.主计时器配置：利用TIM_SelectMasterSlaveMode()函数使能主模式，既然是主模式，那肯定要输出一个触发源，所以还需要调用TIM_SelectOutputTrigger()函数，

TIM_SelectOutputTrigger()常用参数如下：
![image](https://github.com/user-attachments/assets/19bd9bb7-f866-4d7e-a025-a10a28a672c9)

3.从计时器配置：调用TIM_SelectSlaveMode()函数使能从模式，既然是从模式，那肯定需要输入一个触发源，所以还需要调用TIM_SelectInputTrigger()函数，

TIM_SelectInputTrigger()常用参数如下：
![image](https://github.com/user-attachments/assets/dadd49ff-34fd-4c33-aef0-fc4d633581f4)

    
在我这个示例中，TIM3作为TIM2的从机，还作为TIM4的主机，所以需要同时配置主模式和从模式，这并不冲突。

如果需要验证的话，完全可以像上一节一样用高级TIM测PWM，最好用示波器，效果更加明显。这里我就偷偷懒了。
        

  
